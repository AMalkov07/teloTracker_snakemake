================================================================================
ANCHOR-ONLY TESTING MODE - QUICK REFERENCE
================================================================================

WHAT WAS MODIFIED:
  ‚úÖ Y prime BLAST - COMMENTED OUT
  ‚úÖ Y prime parsing - COMMENTED OUT
  ‚úÖ X prime inference - COMMENTED OUT
  ‚úÖ Output shows "ANCHORS ONLY - TESTING MODE"

WHAT STILL WORKS:
  ‚úÖ Anchor BLAST search
  ‚úÖ Strict chromosome matching (synteny enforcement)
  ‚úÖ Quality warnings (95% identity threshold)
  ‚úÖ Quality report generation
  ‚úÖ All output files (GFF3, BED, TSV) - anchors only

================================================================================
HOW TO RUN TEST
================================================================================

Quick Method:
  bash test_anchor_only.sh

Manual Method:
  python scripts/label_pretelomeric_regions.py \
      --reference results/dorado_fast5_7575_day0_PromethION_no_tag_yes_rejection/assembly_7575/assembly_7575_dorado_reference.fasta \
      --anchors references/test_anchors.fasta \
      --yprimes references/repeatmasker_6991_all_y_primes.fasta \
      --output-dir test_output \
      --prefix test_anchors \
      --threads 8

================================================================================
EXPECTED OUTPUT
================================================================================

Console Message:
  "ANCHORS ONLY - TESTING MODE"
  "Summary by chromosome end (ANCHORS ONLY - TESTING MODE):"

Expected Anchors:
  32 total (chr1L, chr1R, chr2L, chr2R, ..., chr16L, chr16R)

Quality Report (Best Case):
  ‚úÖ No quality issues detected!
  All anchors found with high identity (‚â•95%) on expected chromosomes.

Output Files:
  test_output/
  ‚îú‚îÄ‚îÄ test_anchors_7575_anchor_blast.txt    # Raw BLAST (32 hits)
  ‚îú‚îÄ‚îÄ test_anchors_7575.tsv                 # 32 rows (anchors only)
  ‚îú‚îÄ‚îÄ test_anchors_7575.gff3                # 32 anchor features
  ‚îú‚îÄ‚îÄ test_anchors_7575.bed                 # 32 anchor regions
  ‚îî‚îÄ‚îÄ test_anchors_7575_quality_report.txt  # Quality assessment

================================================================================
WHAT TO CHECK
================================================================================

1. Anchor Count:
   grep -c "anchor" test_output/test_anchors_7575.tsv
   Expected: 32

2. Identity Values:
   awk 'NR>1 {print $1, $9}' test_output/test_anchors_7575.tsv
   Expected: Most ‚â•95%, some 85-95% OK

3. Chromosome Matching:
   awk 'NR>1 {print $1, $2}' test_output/test_anchors_7575.tsv
   Expected: chr1L ‚Üí chr1_extended, chr1R ‚Üí chr1_extended, etc.

4. Quality Report:
   cat test_output/test_anchors_7575_quality_report.txt
   Expected: No critical issues

5. No Y primes or X primes in output:
   grep "y_prime\|x_prime" test_output/test_anchors_7575.tsv
   Expected: Empty (no results)

================================================================================
INTERPRETING RESULTS
================================================================================

‚úÖ EXCELLENT (32 anchors, all ‚â•95%, no warnings):
   Strains very similar, high-quality assembly
   ‚Üí Ready to enable Y prime and X prime

‚ö†Ô∏è GOOD (30-32 anchors, most ‚â•95%, 1-2 warnings):
   Minor divergence or assembly gaps
   ‚Üí Verify low-quality anchors in IGV
   ‚Üí Ready to proceed if manually verified

üî¥ CONCERNING (<28 anchors, many <90%, mismatches):
   Assembly issues or significant rearrangement
   ‚Üí Check reference quality
   ‚Üí Lower MIN_PIDENT to 70.0
   ‚Üí Investigate in IGV before proceeding

================================================================================
TROUBLESHOOTING
================================================================================

No anchors found:
  ‚Üí Lower MIN_PIDENT=70.0 in test_anchor_only.sh
  ‚Üí Check BLAST output: cat test_output/*_anchor_blast.txt

Too many missing:
  ‚Üí Check which chr ends: grep "MISSING" test_output/*_quality_report.txt
  ‚Üí Verify those regions assembled: grep "^>" reference.fasta
  ‚Üí Load in IGV to inspect

Chromosome mismatches:
  ‚Üí Review: grep "MISMATCHES" test_output/*_quality_report.txt
  ‚Üí Indicates potential rearrangement or assembly error
  ‚Üí Verify in IGV

Low identity (<95%):
  ‚Üí Expected for some strain divergence
  ‚Üí Check coverage and alignment in BLAST output
  ‚Üí Manually verify in IGV

================================================================================
NEXT STEPS
================================================================================

After successful test:

1. Review all quality metrics
2. Verify sample of anchors in IGV (visual confirmation)
3. If satisfied, uncomment Y prime and X prime sections:
   - Edit scripts/label_pretelomeric_regions.py
   - Remove ## comment markers from lines 625-631, 638-644, 662-665, 671-674
4. Run full pipeline: bash label_regions.sh

================================================================================
FILE LOCATIONS
================================================================================

Test Script:
  test_anchor_only.sh

Modified Python Script:
  scripts/label_pretelomeric_regions.py
  (Y prime and X prime sections commented out)

Documentation:
  ANCHOR_TEST_GUIDE.md         # Detailed testing guide
  SYNTENY_ENFORCEMENT_EXPLANATION.md  # How chromosome matching works
  TESTING_SUMMARY.txt          # This file

Output Directory:
  results/dorado_fast5_7575_day0_PromethION_no_tag_yes_rejection/
    assembly_7575/
      test_anchor_only/

================================================================================
CONTACT
================================================================================

For questions about:
  - Expected results ‚Üí See ANCHOR_TEST_GUIDE.md
  - Chromosome matching ‚Üí See SYNTENY_ENFORCEMENT_EXPLANATION.md
  - Full pipeline ‚Üí See LABELING_PIPELINE_README.md

================================================================================
